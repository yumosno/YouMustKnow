async function fetchPreText() {
    const response = await fetch('config.json');
    const data = await response.json();
    return data.preText;
}

async function callGoogleGemini(fullText) {
    const response = await fetch('https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=AIzaSyAJE1e1be7Pbz9xkZJWAm1dNF_A9vNuUOk', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            contents: [{
                parts: [{
                    text: fullText
                }]
            }]
        })
    });
    
    if (!response.ok) throw new Error('Google Gemini API error');
    
    const result = await response.json();
    return result; // Adjust this based on the actual response structure
}

async function callAnthropicClaude(fullText) {
    const response = await fetch("https://api.anthropic.com/v1/claude/claude-3-sonnet@20240229/generate", {
        method: 'POST',
        headers: {
            'Authorization': 'Bearer YOUR_API_KEY', // Replace with your actual API key
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            messages: [{
                role: "user",
                content: fullText
            }]
        })
    });

    if (!response.ok) throw new Error('Anthropic Claude API error');

    const result = await response.json();
    return result; // Adjust this based on the actual response structure
}

document.getElementById('submitButton').addEventListener('click', async () => {
    const userInput = document.getElementById('userInput').value;

    if (!userInput) {
        alert("Please enter some text.");
        return;
    }

    const preText = await fetchPreText();
    const fullText = `${preText} ${userInput}`;

    // Confirm processing
    const isAcceptable = confirm("Is this text acceptable to be processed?");
    
    if (isAcceptable) {
        try {
            // Call Google Gemini API
            const geminiResult = await callGoogleGemini(fullText);
            document.getElementById('result').innerHTML += `<h3>Google Gemini Result:</h3><pre>${JSON.stringify(geminiResult, null, 2)}</pre>`;
            
            // Call Anthropic Claude API with the same fullText or modified as needed
            const claudeResult = await callAnthropicClaude(fullText);
            document.getElementById('result').innerHTML += `<h3>Anthropic Claude Result:</h3><pre>${JSON.stringify(claudeResult, null, 2)}</pre>`;
            
        } catch (error) {
            console.error(error);
            alert("An error occurred while processing your request.");
        }
    } else {
        alert("Processing was canceled.");
    }
});
